import{I as e,r as t,ai as s,a3 as i,E as o,M as r,n}from"./index-DY0DW88M.js";import a from"./AppPopup-whOF9ytj.js";import{A as l}from"./AppViewSwitchDynamic-Dtsc-8t8.js";import{u as p,S as c}from"./main-DGraFX4g.js";import u from"./AppView-Du2InOAV.js";import d from"./AppHeader-DINik7Wl.js";import m from"./BaseIcon-Bb2ZVMd4.js";import{B as b}from"./BaseItemList-OqIOPpWO.js";import{u as h,a as g,S as w}from"./siteBlockerGroups-CkkkdBQZ.js";import{T as v}from"./ToggleSwitch-DSwcb4Go.js";import{F as f}from"./FormEditableSpan-YM7K4-jK.js";import{B as S}from"./BaseForm-BdYxhfcT.js";import k from"./siteBlockerSession-BLAHUa0_.js";import{T as y}from"./Tooltip-DJa0YW0l.js";import{a as _,b as I}from"./constants-CALDQiUE.js";import{h as B,i as C}from"./constants-CHIvVb_r.js";import{n as A}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{A as D}from"./AppLoading-DWsYUtJy.js";import{F as x}from"./FavIcon-U8dpvQtb.js";import{h as M,c as j}from"./Logger-CErMjlBd.js";import{A as P}from"./AppEmpty-BZlE0N7E.js";import{d as G}from"./state-odjm2uKU.js";import{A as R}from"./AppButtonRow-CtqEDdqG.js";import{A as T}from"./AppActionBanner-CkVuA87P.js";import{computed as E,computedObjectSettings as O,persistentObjectSettings as L}from"./reactiveCustomization-B8WwDagp.js";import{B as V}from"./BaseDropdown-CJtlJqHX.js";import{B as W}from"./BaseDropdownOption-Bn6J2nm1.js";import{C as N}from"./CircleIndicator-DmVR4vlz.js";import{A as U}from"./AppHeaderControl-CYSrwe76.js";import{B as K}from"./BaseDropdownText-CSYTEDLS.js";import{B as F}from"./BaseDropdownDivider-Bay0Demn.js";import{I as z}from"./InlineNumberInput-OeifGtjp.js";import{a as $}from"./modal-CXkRDJ21.js";import{U as H}from"./enums-C0TfsRui.js";import{f as q}from"./flashMessageMixin--L52atuB.js";import{A as X,a as Z}from"./AppConfirmCancel-CipvWVDl.js";import{b as J}from"./constants-KuzCZNtH.js";import{e as Q}from"./DataSyncService-BnTv72BN.js";import"./style-cpFB66wV.js";import"./ResizeSensor-ZXOsDHeC.js";import"./globalKeyEventManager-Dw4DvSNm.js";import"./SmoothReflow-Cnw3bIxd.js";import"./useAllComponentsMounted-RTvHVD2I.js";import"./appViewSwitchMixin-BsLJ76Hr.js";import"./VueBase-EULQJZ9I.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-bvFMkYCE.js";import"./portal-vue.esm-BDTnR1AQ.js";import"./AppContainer-Dy_GGrtc.js";import"./showAnyway-CR--Ivye.js";import"./useAppToggle-GEGV5YXE.js";import"./ViewState-DzCxxm0h.js";import"./appZStack-B9FmF8l5.js";import"./AppDash-CNft_R_U.js";import"./icon-close-DRlspKs3.js";import"./dynamic-import-helper-DIl3ayLm.js";import"./index-CV0q_XsJ.js";import"./constants-BpVlFj04.js";import"./ErrorPulseInput-CkNsRuJq.js";import"./compareObjects-R6Hcs7xe.js";import"./BaseMessage-BBabi6Dl.js";import"./promisifiedChrome-B6V9WMyE.js";import"./focusModeViewState-PmqXWVgL.js";import"./index-DM3Q2nkp.js";import"./PomodoroTimers-CqOVDo7T.js";import"./persistStore-CE5fTtZd.js";import"./settings-rA0qDzbq.js";import"./LocalStorageStoreSyncedItem-kVGQtJA7.js";import"./pomodoroCompleted-Cm_ahB75.js";import"./login-ByohQG_J.js";import"./authService-CEyg9tcu.js";import"./auth-HiWjNVol.js";import"./legacyUserMigration-eNETLKah.js";import"./migrateLegacyUserMessageHandler-HceDQnYT.js";import"./onboarding-Cm39YS_P.js";import"./state-DDN7j9xD.js";import"./BaseDropdownContent-Nf5O_5Ty.js";import"./icon-ellipsis-D7nTOXaQ.js";const Y=e({name:"SiteBlockerGroupsListItem",components:{Tooltip:y,BaseForm:S,FormEditableSpan:f,BaseIcon:m,ToggleSwitch:v},props:{group:{type:Object,required:!0},newGroup:{type:Boolean,default:!1}},setup:()=>({groupsStore:h(),sessionStore:k(),viewStateStore:p(),inlineInputRef:t(),formRef:t(),capture:s("capture"),SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL:B,DropdownPosition:_}),mounted(){var e;this.newGroup&&(null==(e=this.inlineInputRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.group.enabled=!this.group.enabled,!this.newGroup)return null==(e=this.capture)||e.call(this,"site blocker toggle group",{defaultKey:this.group.defaultKey}),this.groupsStore.update(this.group.id,{enabled:this.group.enabled})},createNewGroup(){var e;if(this.newGroup)return this.group.validate(),this.groupsStore.clearActiveItem(),null==(e=this.capture)||e.call(this,"site blocker create new group",{defaultKey:this.group.defaultKey}),this.groupsStore.create(this.group)},async goToGroupWebsitesIfNotNewGroup(){var e;this.newGroup||(this.groupsStore.editItem(this.group.id),await(null==(e=this.viewStateStore)?void 0:e.setActiveView(c.Websites)))}}});const ee=A(e({name:"SiteBlockerGroupsList",components:{BaseIcon:m,SiteBlockerGroupsListItem:A(Y,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("li",{staticClass:"site-blocker-groups-list-item app-list-item-lines-between",attrs:{"data-test":"groups-list-item"},on:{click:e.goToGroupWebsitesIfNotNewGroup}},[t("base-form",{ref:"formRef",staticClass:"list-item-form",attrs:{submit:e.createNewGroup,"submit-button":!1,"submit-on-blur":!0}},[t("div",{staticClass:"list-item-content",class:{editing:e.newGroup}},[t("form-editable-span",{ref:"inlineInputRef",staticClass:"group-websites-input",attrs:{name:"name-input",editing:e.newGroup,placeholder:"New group","data-test":"groups-list-item-input"},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}}),e.newGroup?e._e():t("span",{staticClass:"group-websites-count"},[e._v(e._s(e.group.totalWebsites))]),t("tooltip",{attrs:{label:e.SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL,icon:"lock-keyhole",disabled:!e.group.enabled||!e.sessionStore.actionsDisabled,position:e.DropdownPosition.Bottom}},[t("div",{staticClass:"group-websites-toggle",on:{click:function(e){e.stopPropagation()}}},[t("toggle-switch",{attrs:{value:e.group.enabled,disabled:e.group.enabled&&e.sessionStore.actionsDisabled,"data-test":"groups-list-item-toggle"},on:{click:e.toggleEnabled}})],1)]),t("div",{staticClass:"icon-wrapper group-websites-view u--mobile-show-bg",class:{disabled:e.newGroup},attrs:{"data-test":"groups-list-item-websites"}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-next",size:"10px"}})],1)],1)])],1)}),[],!1,null,"4667b73c").exports,BaseItemList:b},setup:()=>({groupsStore:h()}),computed:{editingExistingGroup(){return!!this.groupsStore.activeItem&&!!this.groupsStore.getGroupOrDefaultFromId(this.groupsStore.activeItem.id)}},methods:{createNewGroup(){this.groupsStore.newItem()}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-list"},[t("div",{staticClass:"groups-header"},[t("span",{staticClass:"groups-header-title"},[e._v("Blocked groups")]),t("div",{staticClass:"icon-wrapper",attrs:{"data-test":"new-group"},on:{click:e.createNewGroup}},[t("base-icon",{attrs:{src:"icon-plus",size:"12px"}})],1)]),t("base-item-list",[e.groupsStore.activeItem&&!e.editingExistingGroup?t("site-blocker-groups-list-item",{key:e.groupsStore.activeItem.id,attrs:{group:e.groupsStore.activeItem,"new-group":!0}}):e._e(),e._l(e.groupsStore.items,(function(e){return t("site-blocker-groups-list-item",{key:e.id,attrs:{group:e}})}))],2)],1)}),[],!1,null,"122d134f").exports,te=e({name:"SiteBlockerGroupsBlockingBannerIcon",components:{FavIcon:x},props:{url:{type:String,required:!0}},setup:()=>({yDisplacement:"0rem",xDisplacement:"0rem",animationStart:"0s",animationSpeed:"10s"}),created(){this.yDisplacement=4*Math.random()-2+"rem",this.xDisplacement=2.25*Math.random()+1.5+"rem";const e=5*Math.random()+35;this.animationSpeed=e+"s",this.animationStart=-1*Math.random()*e+"s"}}),se=()=>{i(((e,t)=>({"99fb043a":e.xDisplacement,"201f1e6f":e.animationSpeed,"2020e28a":e.animationStart,bcf4f738:e.yDisplacement})))},ie=te.setup;te.setup=ie?(e,t)=>(se(),ie(e,t)):se;const oe=A(te,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-blocking-banner-icon"},[t("fav-icon",{staticClass:"favicon",attrs:{url:e.url}})],1)}),[],!1,null,"b6e1f749").exports,re=e({name:"SiteBlockerGroupsBlockingBannerBrowser",components:{BaseIcon:m},setup:()=>({sessionStore:k()}),computed:{unstoppableModeActive(){return this.sessionStore.unstoppableModeActive},icon(){return this.unstoppableModeActive?"octagon-x":"ban"},message(){return this.unstoppableModeActive?"Unstoppable Mode":"Blocking distractions"}}});const ne=A(e({name:"SiteBlockerGroupsBlockingBanner",components:{SiteBlockerGroupsBlockingBannerBrowser:A(re,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{ref:"browser",staticClass:"site-blocker-groups-blocking-banner-browser",class:{unstoppable:e.sessionStore.unstoppableModeActive},attrs:{"data-test":"blocking-browser"}},[e._m(0),t("div",{staticClass:"blocking-viewport"},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("base-icon",{attrs:{src:e.icon,size:"1.5rem"}})],1),t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("span",{key:e.message,staticClass:"blocking-message"},[e._v(e._s(e.message))])])],1)])}),[function(){var e=this._self._c;return this._self._setupProxy,e("div",{staticClass:"blocking-nav"},[e("div",{staticClass:"nav-item"}),e("div",{staticClass:"nav-item"}),e("div",{staticClass:"nav-item"}),e("div",{staticClass:"nav-item nav-bar"})])}],!1,null,"dd7ac407").exports,SiteBlockerGroupsBlockingBannerIcon:oe},setup:()=>({sessionStore:k(),iconRangeInterval:void 0}),data:()=>({visibleIconRangeMin:0,visibleIconRangeMax:0,iconsVisible:!1}),computed:{urls(){return""===this.sessionStore.urls?[]:this.sessionStore.urls.replaceAll("*","com").split(" ")}},watch:{urls(){this.setRandomIconRange()}},created(){this.setRandomIconRange(),this.iconRangeInterval=setInterval((()=>{this.visibleIconRangeMin=M(this.urls,this.visibleIconRangeMin,1),this.visibleIconRangeMax=M(this.urls,this.visibleIconRangeMax,1)}),5e3),setTimeout((()=>{this.iconsVisible=!0}),200)},destroyed(){clearInterval(this.iconRangeInterval)},methods:{setRandomIconRange(){const e=Math.floor(Math.random()*this.urls.length);this.visibleIconRangeMin=e,this.visibleIconRangeMax=M(this.urls,e,Math.min(this.urls.length-1,10))},isIconInRange(e){return this.visibleIconRangeMax<this.visibleIconRangeMin?e>=0&&e<=this.visibleIconRangeMax||e>=this.visibleIconRangeMin&&e<=this.urls.length-1:(e-this.visibleIconRangeMin)*(e-this.visibleIconRangeMax)<=0}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("transition-group",{staticClass:"site-blocker-groups-blocking-banner",attrs:{tag:"div",name:"slow-fade-icon"}},[t("site-blocker-groups-blocking-banner-browser",{key:"browser"}),e._l(e.urls,(function(s,i){return e.iconsVisible&&e.isIconInRange(i)?t("site-blocker-groups-blocking-banner-icon",{key:`${s}`,attrs:{url:s}}):e._e()}))],2)}),[],!1,null,"374c5e31").exports;const ae=A(e({name:"TimeDisplay",props:{hours:{type:Number,default:0},minutes:{type:Number,default:0},seconds:{type:Number,default:0}},computed:{displayHours(){return E.hour12clock&&this.hours>12?this.hours-12:this.hours},displayMinutes(){return`${this.minutes<10&&0!==this.hours?"0":""}${this.minutes}`},displaySeconds(){return`${this.seconds<10?"0":""}${this.seconds}`}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("span",{staticClass:"time-display",class:{"has-hours":0!==e.displayHours,"slim-minutes":0===e.displayHours&&1===e.displayMinutes.length}},[0!==e.hours?[t("span",{staticClass:"hours"},[e._v(e._s(e.displayHours))]),t("span",{staticClass:"colon"},[e._v(":")])]:e._e(),t("span",{staticClass:"minutes"},[e._v(e._s(e.displayMinutes))]),t("span",{staticClass:"colon"},[e._v(":")]),t("span",{staticClass:"seconds"},[e._v(e._s(e.displaySeconds))])],2)}),[],!1,null,"e64b7611").exports,le=e({name:"SiteBlockerGroupsUnstoppableMode",components:{InlineNumberInput:z,BaseIcon:m,BaseDropdown:V,BaseDropdownDivider:F,BaseDropdownText:K,Tooltip:y,AppHeaderControl:U,BaseDropdownOption:W,CircleIndicator:N},mixins:[q],setup:()=>({sessionStore:k(),durationInput:t(),unstoppableDropdown:t(),capture:s("capture"),DropdownOptionSpacing:I,DropdownPosition:_}),computed:{unstoppableModeProgress(){const e=this.unstoppableModeDurationMinutes*o;return(e-this.sessionStore.unstoppableModeTimeRemainingSeconds*r)/e},unstoppableModeMinutes(){return Math.ceil(this.sessionStore.unstoppableModeTimeRemainingSeconds/60)},unstoppableModeTooltipLabel(){return`${this.unstoppableModeMinutes}m left in Unstoppable Mode`},unstoppableModeMinutesCharacters(){return this.unstoppableModeMinutes.toString().length},unstoppableModeDurationMinutes:{get:()=>O.siteBlockerSettings.unstoppableModeDurationMinutes,set(e){L.siteBlockerSettings={...L.siteBlockerSettings,unstoppableModeDurationMinutes:e}}}},methods:{editUnstoppableModeDuration(){var e;null==(e=this.durationInput)||e.focus()},startUnstoppableMode(){var e,t;0===this.sessionStore.unstoppableModeTimestamp&&this.showFlashMessage({message:"In Unstoppable Mode, site blocking can't be disabled.",closeButtonEnabled:!0,persist:!0,buttons:[{text:"I understand",action:()=>{},dismissOnClick:!0},{text:"Cancel",action:()=>{var e;this.sessionStore.stopUnstoppableMode(),null==(e=this.capture)||e.call(this,"site blocker unstoppable mode cancel")},dismissOnClick:!0}]}),null==(e=this.unstoppableDropdown)||e.closeDropdown(),this.sessionStore.startUnstoppableMode(),null==(t=this.capture)||t.call(this,"site blocker unstoppable mode start",{duration:this.sessionStore.siteBlockerSettings.unstoppableModeDurationMinutes}),this.sessionStore.ensurePermissions()},openUnstoppableUpsell(){$(H.SITE_BLOCKER_UNSTOPPABLE,"site-blocker")}}});const pe=A(e({name:"SiteBlockerGroups",components:{SiteBlockerGroupsUnstoppableMode:A(le,(function(){var e=this,t=e._self._c;return e._self._setupProxy,e.sessionStore.unstoppableModeFeatureEnabled?t("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e.sessionStore.unstoppableModeActive?t("tooltip",{key:"indicator",staticClass:"unstoppable-indicator",attrs:{icon:"octagon-x",label:e.unstoppableModeTooltipLabel,position:e.DropdownPosition.Bottom}},[t("div",{staticClass:"icon-wrapper",attrs:{"data-test":"unstoppable-indicator"}},[t("circle-indicator",{attrs:{progress:e.unstoppableModeProgress,size:"32px","stroke-width":"10px"}}),t("div",{staticClass:"time-remaining",style:{"--ch":e.unstoppableModeMinutesCharacters}},[e._v(e._s(e.unstoppableModeMinutes))])],1)]):t("base-dropdown",{key:"dropdown",ref:"unstoppableDropdown",attrs:{id:"site-blocker-unstoppable-mode","data-test":"unstoppable-mode"},scopedSlots:e._u([{key:"toggle",fn:function(){return[t("div",{staticClass:"icon-wrapper"},[t("base-icon",{staticClass:"icon",attrs:{src:"octagon-x",size:"18px"}})],1)]},proxy:!0}],null,!1,2161479190)},[t("base-dropdown-text",[t("p",{staticClass:"heading"},[e._v("Unstoppable Mode")]),t("p",[e._v("Prevents disabling and bypassing")])]),t("base-dropdown-divider"),t("base-dropdown-option",{attrs:{spacing:e.DropdownOptionSpacing.Between},on:{click:e.editUnstoppableModeDuration}},[t("span",[e._v("Duration")]),t("div",[t("inline-number-input",{ref:"durationInput",attrs:{max:1440,min:1},model:{value:e.unstoppableModeDurationMinutes,callback:function(t){e.unstoppableModeDurationMinutes=t},expression:"unstoppableModeDurationMinutes"}}),e._v(" min")],1)]),t("base-dropdown-option",{attrs:{"data-test":"start-unstoppable-mode"},on:{click:e.startUnstoppableMode}},[t("base-icon",{attrs:{src:"play"}}),t("span",[e._v("Start")])],1)],1)],1):t("app-header-control",{attrs:{id:"site-blocker-unstoppable-mode","data-test":"unstoppable-mode"},on:{click:e.openUnstoppableUpsell}},[t("base-icon",{attrs:{src:"octagon-x",size:"18px"}})],1)}),[],!1,null,"068bbda7").exports,ToggleSwitch:v,BaseDropdownOption:W,BaseDropdown:V,TimeDisplay:ae,AppActionBanner:T,AppButtonRow:R,AppEmpty:P,AppLoading:D,SiteBlockerGroupsBlockingBanner:ne,SiteBlockerGroupsList:ee,BaseIcon:m,AppHeader:d,AppView:u},setup:()=>({groupsStore:h(),websitesStore:g(),sessionStore:k(),capture:s("capture"),SITE_BLOCKER_GRACE_PERIOD_TOOLTIP_TEXT:C,DropdownOptionSpacing:I}),computed:{loaded(){return this.groupsStore.loaded&&this.websitesStore.loaded&&this.sessionStore.loaded},hasActiveItem(){return!!this.groupsStore.activeItem},empty(){return 0===this.groupsStore.items.length},focusModeActive:()=>G.currentValue,manualToggleControlsVisible(){return!this.focusModeActive&&!this.sessionStore.unstoppableModeActive&&!this.empty&&this.loaded},gracePeriodMinutes(){return Math.floor(this.sessionStore.gracePeriodTimeRemainingSeconds/60)},gracePeriodSeconds(){return this.sessionStore.gracePeriodTimeRemainingSeconds%60},activeDuringPomodoroBreak:{get:()=>O.siteBlockerSettings.activeDuringPomodoroBreak,set(e){L.siteBlockerSettings={...L.siteBlockerSettings,activeDuringPomodoroBreak:e}}}},created(){this.groupsStore.refresh(),this.websitesStore.refresh()},methods:{createNewGroup(){this.groupsStore.newItem()},async toggleBlockingActive(){var e;const t=this.sessionStore.manuallyActive;!t&&this.sessionStore.checkSiteBlockerFeatureDisabledAndOpenUpsell()||(await this.sessionStore.update({manuallyActive:!t}),null==(e=this.capture)||e.call(this,"site blocker manual toggle active",{active:this.sessionStore.manuallyActive}),this.sessionStore.manuallyActive&&this.sessionStore.ensurePermissions())},toggleActiveDuringBreak(){var e;this.activeDuringPomodoroBreak=!this.activeDuringPomodoroBreak,null==(e=this.capture)||e.call(this,"site blocker active during break toggle",{active:this.activeDuringPomodoroBreak})}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-groups",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:"icon/apps/site-blocker",size:"16px"}}),t("span",{staticClass:"app-header-name"},[e._v("Site Blocker")])]},proxy:!0},{key:"right",fn:function(){return[t("site-blocker-groups-unstoppable-mode"),t("base-dropdown",{attrs:{"min-width":"240px","data-test":"blocker-settings-dropdown"}},[t("base-dropdown-option",{attrs:{spacing:e.DropdownOptionSpacing.Between,"data-test":"block-during-breaks"},on:{click:e.toggleActiveDuringBreak}},[t("span",[e._v("Block during breaks")]),t("toggle-switch",{attrs:{value:e.activeDuringPomodoroBreak}})],1)],1)]},proxy:!0}])}),e.sessionStore.featureEnabled&&!e.sessionStore.hasPermissions?t("app-action-banner",{staticClass:"header-banner"},[t("span",[t("button",{staticClass:"banner-action",attrs:{"data-test":"grant-permissions"},on:{click:function(t){return e.sessionStore.ensurePermissions(!0)}}},[e._v(" Grant permissions  "),t("base-icon",{attrs:{src:"list-check",size:"15px"}})],1),e._v(" to enable Site Blocker ")])]):e._e(),e.sessionStore.featureEnabled||e.focusModeActive?e._e():t("app-action-banner",{staticClass:"header-banner"},[t("span",[t("button",{staticClass:"banner-action",on:{click:e.sessionStore.checkSiteBlockerFeatureDisabledAndOpenUpsell}},[e._v(" Renew Plus subscription  "),t("base-icon",{attrs:{src:"circle-fading-arrow-up",size:"15px"}})],1),e._v(" to enable Site Blocker ")])]),e.manualToggleControlsVisible?t("app-button-row",[t("button",{staticClass:"button",attrs:{"data-test":"toggle-blocking"},on:{click:e.toggleBlockingActive}},[e._v(" "+e._s(e.sessionStore.manuallyActive?"Stop":"Start")+" blocking websites ")])]):e._e()]},proxy:!0},{key:"body",fn:function(){return[t("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e.loaded?t("div",[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a group to get started","button-text":"Add Group","button-data-test":"new-group-empty"},on:{buttonClick:e.createNewGroup}}):[e.sessionStore.activeAndBlockingUrls?t("site-blocker-groups-blocking-banner",{class:{"toggle-visible":e.manualToggleControlsVisible}}):e._e(),t("site-blocker-groups-list")]],2):t("app-loading",{attrs:{"data-test":"groups-loading"}})],1)]},proxy:!0},{key:"footer",fn:function(){return[e.sessionStore.gracePeriodActive?t("app-action-banner",{staticClass:"footer-banner",attrs:{id:"site-blocker-grace-period","tooltip-text":e.SITE_BLOCKER_GRACE_PERIOD_TOOLTIP_TEXT}},[t("base-icon",{attrs:{src:"lock-keyhole-open",size:"14px","stroke-width":"2.5px"}}),t("span",[t("time-display",{attrs:{minutes:e.gracePeriodMinutes,seconds:e.gracePeriodSeconds}}),t("span",[e._v(" ")]),t("span",[e._v("left to adjust blocked sites")])],1)],1):e._e()]},proxy:!0}])})}),[],!1,null,"ef9e25e4").exports;const ce=A(e({name:"BaseDropdownConfirmation",components:{AppConfirmCancel:X},props:Z,emits:["cancel","delete"],setup:()=>({AppConfirmCancelType:J})}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("app-confirm-cancel",e._g(e._b({attrs:{"data-test":"dropdown-confirm-delete"}},"app-confirm-cancel",e.$props,!1),e.$listeners))],1)}),[],!1,null,"7f4cb52f").exports,ue=e({name:"SiteBlockerWebsitesListItem",components:{Tooltip:y,BaseDropdownConfirmation:ce,FormEditableSpan:f,BaseForm:S,FavIcon:x,BaseIcon:m,BaseDropdownOption:W,BaseDropdown:V,ToggleSwitch:v},props:{website:{type:Object,required:!0},editing:{type:Boolean,default:!1},newWebsite:{type:Boolean,default:!1}},setup:()=>({viewStateStore:p(),websitesStore:g(),sessionStore:k(),websitesDropdownRef:t(),inputNameRef:t(),inputUrlRef:t(),capture:s("capture"),SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL:B,DropdownPosition:_}),computed:{urlNameIfEmpty(){var e,t;if(this.website.name)return this.website.name;const s=null==(t=null==(e=this.website.url)?void 0:e.split("."))?void 0:t.at(-2);return s&&s.length>4&&j(s)||""},namePlaceholder(){return""===this.website.url||""===this.urlNameIfEmpty?"Website Name":this.urlNameIfEmpty},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===J.Dropdown}},mounted(){var e;this.newWebsite&&(null==(e=this.inputUrlRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.website.enabled=!this.website.enabled,!this.newWebsite)return null==(e=this.capture)||e.call(this,"site blocker toggle website"),this.websitesStore.update(this.website.id,{enabled:this.website.enabled})},async editWebsiteUnlessActionsDisabled(e){var t,s,i,o,r;this.sessionStore.actionsDisabled||((!this.websitesStore.activeItem||!this.editing&&await(null==(t=this.viewStateStore)?void 0:t.setConfirmation({title:"Are you sure you want to edit?",description:"All unsaved changes will be lost!",type:J.Dropdown})))&&(null==(s=this.capture)||s.call(this,"site blocker edit website",{defaultKey:this.website.defaultKey}),this.websitesStore.editItem(this.website.id)),null==(i=this.websitesDropdownRef)||i.closeDropdown(),await n(),e?null==(o=this.inputNameRef)||o.focus():null==(r=this.inputUrlRef)||r.focus())},async deleteWebsite(){var e,t,s,i;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete?",type:J.Dropdown}))&&(null==(t=this.websitesDropdownRef)||t.closeDropdown(),await this.websitesStore.delete(this.website.id),null==(s=this.capture)||s.call(this,"site blocker delete website",{defaultKey:this.website.defaultKey}),(null==(i=this.websitesStore.activeItem)?void 0:i.id)===this.website.id&&this.websitesStore.clearActiveItem())},validateWebsite(){this.website.name=this.urlNameIfEmpty,this.website.validate()},async createNewWebsiteOrUpdateIfNameUrl(){var e,t;if(this.editing)return this.websitesStore.clearActiveItem(),this.newWebsite?(null==(e=this.capture)||e.call(this,"site blocker create website",{defaultKey:this.website.defaultKey}),this.websitesStore.create(this.website)):(null==(t=this.capture)||t.call(this,"site blocker update website",{defaultKey:this.website.defaultKey}),this.websitesStore.update(this.website.id,{name:this.website.name,url:this.website.url}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const de=e({name:"SiteBlockerWebsitesList",components:{SiteBlockerWebsitesListItem:A(ue,(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("li",{staticClass:"site-blocker-websites-list-item app-list-item-lines-between",attrs:{"data-test":"websites-list-item"}},[i("base-form",{staticClass:"list-item-form",class:{editing:s.editing},attrs:{submit:s.createNewWebsiteOrUpdateIfNameUrl,validate:s.validateWebsite,"submit-button":!1,"submit-on-blur":!0}},[i("div",{staticClass:"list-item-top-row"},[s.editing?s._e():i("fav-icon",{staticClass:"url-favicon",attrs:{url:s.website.urlWithReplacedWildcard}}),i("form-editable-span",{ref:"inputNameRef",staticClass:"name-input",attrs:{editing:s.editing,name:"name-input",placeholder:s.namePlaceholder,"data-test":"websites-list-item-name-input"},nativeOn:{dblclick:function(e){return s.editWebsiteUnlessActionsDisabled(!0)}},model:{value:s.website.name,callback:function(e){s.$set(s.website,"name",e)},expression:"website.name"}}),i("tooltip",{attrs:{label:s.SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL,icon:"lock-keyhole",disabled:!s.website.enabled||!s.sessionStore.actionsDisabled,position:s.DropdownPosition.Bottom}},[i("div",{staticClass:"item-toggle",on:{click:function(e){e.stopPropagation()}}},[i("toggle-switch",{attrs:{value:s.website.enabled,disabled:s.website.enabled&&s.sessionStore.actionsDisabled,"data-test":"websites-list-item-toggle"},on:{click:s.toggleEnabled}})],1)]),i("base-dropdown",{ref:"websitesDropdownRef",attrs:{"data-test":"website-options-dropdown"},on:{toggle:s.clearConfirmationIfOpen}},[s.dropdownConfirmationVisible&&(null==(e=s.viewStateStore)?void 0:e.confirmationProps)?i("base-dropdown-confirmation",s._b({},"base-dropdown-confirmation",null==(t=s.viewStateStore)?void 0:t.confirmationProps,!1)):[i("tooltip",{attrs:{label:s.SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL,icon:"lock-keyhole",disabled:!s.sessionStore.actionsDisabled,position:s.DropdownPosition.Right,"data-test":"edit-website-tooltip"}},[i("base-dropdown-option",{attrs:{"data-test":"edit-website",disabled:s.sessionStore.actionsDisabled},on:{click:function(e){return s.editWebsiteUnlessActionsDisabled(!1)}}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),s._v(" Edit ")],1)],1),i("tooltip",{attrs:{label:s.SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL,icon:"lock-keyhole",disabled:!s.sessionStore.actionsDisabled,position:s.DropdownPosition.Right}},[i("base-dropdown-option",{attrs:{"data-test":"delete-website",disabled:s.sessionStore.actionsDisabled},on:{click:s.deleteWebsite}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),s._v(" Delete ")],1)],1)]],2)],1),i("div",{staticClass:"list-item-bottom-row"},[i("form-editable-span",{ref:"inputUrlRef",staticClass:"url-input",attrs:{editing:s.editing,name:"url-input",placeholder:"URL","data-test":"websites-list-item-url-input"},nativeOn:{dblclick:function(e){return s.editWebsiteUnlessActionsDisabled(!1)}},model:{value:s.website.url,callback:function(e){s.$set(s.website,"url",e)},expression:"website.url"}})],1)])],1)}),[],!1,null,"de0f3a38").exports,BaseItemList:b},setup:()=>({websitesStore:g(),groupsStore:h()}),computed:{activeGroup(){return this.groupsStore.activeItem??new w({order:this.groupsStore.items.length})},websites(){return this.websitesStore.getWebsitesByGroup(this.activeGroup)},editingExistingWebsite(){return!!this.websitesStore.activeItem&&!!this.websitesStore.getWebsiteOrDefaultFromId(this.websitesStore.activeItem.id)}},methods:{createNewWebsite(){this.websitesStore.newItem(this.activeGroup)}}});const me=e({name:"SiteBlockerWebsites",components:{Tooltip:y,AppActionBanner:T,BaseDropdownConfirmation:ce,BaseForm:S,AppEmpty:P,AppConfirmCancel:X,SiteBlockerWebsitesList:A(de,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("base-item-list",[e.websitesStore.activeItem&&!e.editingExistingWebsite?t("site-blocker-websites-list-item",{key:e.websitesStore.activeItem.id,attrs:{website:e.websitesStore.activeItem,editing:!0,"new-website":!0}}):e._e(),e._l(e.websites,(function(s){var i,o;return t("site-blocker-websites-list-item",{key:s.id,attrs:{website:(null==(i=e.websitesStore.activeItem)?void 0:i.id)===s.id?e.websitesStore.activeItem:s,editing:(null==(o=e.websitesStore.activeItem)?void 0:o.id)===s.id}})}))],2)}),[],!1,null,null).exports,BaseDropdownOption:W,BaseDropdown:V,FormEditableSpan:f,AppHeaderControl:U,AppView:u,AppHeader:d,BaseIcon:m},setup:()=>({viewStateStore:p(),groupsStore:h(),websitesStore:g(),sessionStore:k(),nameInputRef:t(),groupDropdownRef:t(),capture:s("capture"),SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL:B,DropdownPosition:_}),data:()=>({editingGroupName:!1}),computed:{activeGroup(){return this.groupsStore.activeItem??new w({order:this.groupsStore.items.length})},hasActiveItem(){return!!this.websitesStore.activeItem},empty(){return 0===this.websitesStore.getWebsitesByGroup(this.activeGroup).length},overlayConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===J.Overlay},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===J.Dropdown}},mounted(){this.viewStateStore&&(this.viewStateStore.beforeViewChange=()=>(this.editingGroupName||this.websitesStore.activeItemHasChanges)&&this.viewStateStore?this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",description:"All unsaved changes will be lost!",type:J.Overlay,dashboardOverlay:!0}):Promise.resolve(!0))},destroyed(){var e;null==(e=this.viewStateStore)||e.resetBeforeViewChange(),this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{async goToGroups(){var e;await(null==(e=this.viewStateStore)?void 0:e.setActiveView(c.Groups))},createNewWebsite(){this.websitesStore.newItem(this.activeGroup)},async renameGroup(){var e,t;null==(e=this.groupDropdownRef)||e.closeDropdown(),this.editingGroupName=!0,await n(),null==(t=this.nameInputRef)||t.focus()},async deleteGroup(){var e,t,s;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete this group?",type:J.Dropdown}))&&(null==(t=this.groupDropdownRef)||t.closeDropdown(),this.websitesStore.clearActiveItem(),null==(s=this.capture)||s.call(this,"site blocker delete group",{defaultKey:this.activeGroup.defaultKey}),await this.groupsStore.delete(this.activeGroup.id),await this.goToGroups())},updateGroupNameIfName(){var e;""!==this.activeGroup.name&&(this.editingGroupName=!1,null==(e=this.capture)||e.call(this,"site blocker update group",{defaultKey:this.activeGroup.defaultKey}),this.groupsStore.update(this.activeGroup.id,{name:this.activeGroup.name}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const be=A(e({name:"SiteBlockerApp",components:{SiteBlockerWebsites:A(me,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-websites",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{attrs:{"data-test":"go-to-groups"},on:{click:e.goToGroups}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/arrow-left"}})],1),t("base-form",{staticClass:"app-header-name group-name-form",attrs:{submit:e.updateGroupNameIfName,"submit-button":!1,"submit-on-blur":!0}},[t("form-editable-span",{ref:"nameInputRef",staticClass:"name-input",attrs:{placeholder:"Edit group",editing:e.editingGroupName,"data-test":"websites-group-name-input"},nativeOn:{dblclick:function(t){return e.renameGroup.apply(null,arguments)}},model:{value:e.activeGroup.name,callback:function(t){e.$set(e.activeGroup,"name",t)},expression:"activeGroup.name"}})],1)]},proxy:!0},{key:"right",fn:function(){var s,i;return[t("app-header-control",{attrs:{"show-mobile-background":!0,active:!0,"data-test":"new-website"},on:{click:e.createNewWebsite}},[t("base-icon",{attrs:{src:"icon-plus"}})],1),t("base-dropdown",{ref:"groupDropdownRef",attrs:{"data-test":"group-options-dropdown"},on:{toggle:e.clearConfirmationIfOpen}},[e.dropdownConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("base-dropdown-confirmation",e._b({},"base-dropdown-confirmation",null==(i=e.viewStateStore)?void 0:i.confirmationProps,!1)):[t("base-dropdown-option",{attrs:{"data-test":"edit-group"},on:{click:e.renameGroup}},[t("base-icon",{attrs:{src:"icon-edit"}}),e._v(" Rename ")],1),t("tooltip",{attrs:{label:e.SITE_BLOCKER_ACTIVE_TOOLTIP_LABEL,icon:"lock-keyhole",disabled:!e.sessionStore.actionsDisabled,position:e.DropdownPosition.Right,"data-test":"delete-group-tooltip"}},[t("base-dropdown-option",{attrs:{"data-test":"delete-group",disabled:e.sessionStore.actionsDisabled},on:{click:e.deleteGroup}},[t("base-icon",{attrs:{src:"icon/delete"}}),e._v(" Delete ")],1)],1)]],2)]},proxy:!0}])}),e.sessionStore.hasPermissions?e._e():t("app-action-banner",[t("span",[t("button",{staticClass:"banner-action",attrs:{"data-test":"grant-permissions"},on:{click:function(t){return e.sessionStore.ensurePermissions(!0)}}},[e._v(" Grant permissions  "),t("base-icon",{attrs:{src:"list-check",size:"15px"}})],1),e._v(" to enable Site Blocker ")])])]},proxy:!0},{key:"body",fn:function(){return[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a website to get started","button-text":"Add Website","button-data-test":"new-website-empty"},on:{buttonClick:e.createNewWebsite}}):t("site-blocker-websites-list")]},proxy:!0},{key:"confirm",fn:function(){var s;return[e.overlayConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0}])})}),[],!1,null,"74974ab6").exports,SiteBlockerGroups:pe,AppPopup:a,AppViewSwitchDynamic:l},setup:()=>({groupsStore:h(),websitesStore:g(),viewStateStore:p()}),computed:{groupsViewActive(){return this.viewStateStore.activeViewId===c.Groups},websitesViewActive(){return this.viewStateStore.activeViewId===c.Websites}},destroyed(){this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{checkViewsOpen(){this.checkSiteBlockerGroupViewOpen(),this.checkSiteBlockerWebsitesViewOpen()},checkSiteBlockerGroupViewOpen(){this.groupsViewActive?Q.$emit("siteBlockerGroups:opened"):Q.$emit("siteBlockerGroups:closed")},checkSiteBlockerWebsitesViewOpen(){this.websitesViewActive?Q.$emit("siteBlockerWebsites:opened"):Q.$emit("siteBlockerWebsites:closed")}}}),(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("app-popup",{attrs:{position:"bottom-right",region:"top-left",width:320,focused:s.viewStateStore.focused},on:{close:function(e){return s.viewStateStore.togglePopup(!1)}},nativeOn:{click:function(e){return s.viewStateStore.focus()}}},[i("app-view-switch-dynamic",{attrs:{"order-key":null==(t=null==(e=s.viewStateStore)?void 0:e.activeView)?void 0:t.order},on:{afterTransition:s.checkViewsOpen}},[s.groupsViewActive?i("site-blocker-groups"):s._e(),s.websitesViewActive?i("site-blocker-websites"):s._e()],1)],1)}),[],!1,null,"721f43eb").exports;export{be as default};