import{a as e,T as t,A as s,I as r,aA as a}from"./index-DY0DW88M.js";import{I as i}from"./IframeHost-CHjPJneS.js";import{a as o,b as n,c as m,d as l,e as p,f as d}from"./IframeMessenger-Bl7PPCjo.js";import{a as u}from"./authService-CEyg9tcu.js";import{a as g}from"./DataSyncService-BnTv72BN.js";import{n as c}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{U as f}from"./UpgradeModalLayout-ADFfN_Rh.js";import"./Logger-CErMjlBd.js";import"./style-cpFB66wV.js";import"./icon-error-state-DPDi2Xf2.js";import"./auth-HiWjNVol.js";import"./persistStore-CE5fTtZd.js";import"./legacyUserMigration-eNETLKah.js";import"./enums-C0TfsRui.js";import"./migrateLegacyUserMessageHandler-HceDQnYT.js";import"./reactiveCustomization-B8WwDagp.js";import"./feel-focused-Cmh8GW4d.js";import"./stay-on-task-C4IAAUIP.js";import"./tasks-completed-g7itYxRk.js";import"./partner-Xu2c1ljz.js";import"./BaseIcon-Bb2ZVMd4.js";import"./dynamic-import-helper-DIl3ayLm.js";import"./icon-back-D7vBl-rG.js";import"./ModalBox-e_qFZdvQ.js";import"./SubscriptionSummary-BQ9oLLHV.js";import"./ModalLayout-Z_kFVyOI.js";const y={userUuid:e.getUserUuid()??""},h={[o]:async()=>{if(!e.getUserUuid())return;const{otp:t}=await u.generateOneTimePassword();return{otp:t}},[n]:async()=>{var e;const{data:t}=await g.get("/user/profile?details=1");localStorage.setItem("email",(null==(e=t.emails[0])?void 0:e.email)??""),localStorage.removeItem("unregistered"),localStorage.removeItem("registrationStatePending")}},j=new t("tab.iframe",.1),v=({event:e},t)=>{j.error(e,{feature:t.id})},M={[m]:v,[l]:v},b={[p]:({eventName:e,eventOptions:t})=>{s.capture(e,t)}};var U="https://www.momentumdash.com/";function S(e,t={}){return a()&&(t.captureAnalytics="true"),new d(e,{params:{...y,...t},events:{...h,...M,...b}})}const I=r({name:"UpgradeModalIframe",components:{IframeHost:i},props:{feature:{type:String,required:!0},startingHeight:{type:String,required:!0},plans:{type:Object,default:()=>({})}},emits:["complete"],setup:e=>({messenger:"free-trial"===e.feature?null:S(e.feature)}),data:()=>({messengerReady:!1}),computed:{fallbackUrl(){return`${U}setup/plus/${this.feature}`}},watch:{plans:{handler(e){if(Object.keys(e).length&&!this.messenger){const{friendlyMonthlyPrice:t,trialDays:s,id:r}=(null==e?void 0:e.yearly)||{};this.messenger=S(this.feature,{friendlyMonthlyPrice:t,trialDays:(null==s?void 0:s.toString())||"",planId:r}),this.addMessengerListeners()}},immediate:!0}},created(){this.addMessengerListeners()},destroyed(){var e;null==(e=this.messenger)||e.disconnect()},methods:{addMessengerListeners(){this.messenger&&(this.messenger.addMessageListener("complete",(()=>{this.$emit("complete")})),this.messengerReady=!0)}}});const w=c(r({name:"UpgradeModal",components:{UpgradeModalIframe:c(I,(function(){var e=this,t=e._self._c;return e._self._setupProxy,e.messengerReady&&e.messenger?t("iframe-host",{attrs:{messenger:e.messenger,"data-test":"upgrade-modal-iframe","starting-height":e.startingHeight,"fallback-url":e.fallbackUrl}}):e._e()}),[],!1,null,null).exports,UpgradeModalLayout:f},props:{feature:{type:String,required:!0},plans:{type:Object,default:()=>({})},startingHeight:{type:String,required:!0},closeButtonEnabled:{type:Boolean,default:!0}},emits:["dismiss","stepComplete"]}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("upgrade-modal-layout",{staticClass:"upgrade-modal",attrs:{"close-button-enabled":e.closeButtonEnabled,"data-test":"upgrade-modal"},on:{dismiss:function(t){return e.$emit("dismiss")}}},[t("upgrade-modal-iframe",{staticClass:"upgrade-modal-iframe",attrs:{feature:e.feature,plans:e.plans,"starting-height":e.startingHeight},on:{complete:function(t){return e.$emit("stepComplete")}}})],1)}),[],!1,null,"fc3d2b66").exports;export{w as default};