const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/calendarEvents-B6LH1_nk.js","assets/js/DataSyncService-BnTv72BN.js","assets/js/index-DY0DW88M.js","assets/js/Logger-CErMjlBd.js","assets/js/style-cpFB66wV.js","assets/css/style-CrTXrpPu.css","assets/js/index-BRbZHaSZ.js","assets/js/reactiveCustomization-B8WwDagp.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./style-cpFB66wV.js";import{m as a}from"./Logger-CErMjlBd.js";import{A as t}from"./index-DY0DW88M.js";import{a as n}from"./DataSyncService-BnTv72BN.js";let r=null;const s=async()=>{const e=await a.get("googleCalendarAccessToken"),[t,n]=(e||"").split(",");if(n&&Number(t)>Date.now())return n;{null===r&&(r=o());const e=await r;return e?(await a.set("googleCalendarAccessToken",e),r=null,e.split(",")[1]):(await a.delete("googleCalendarAccessToken"),r=null,null)}},o=async()=>{try{const e=await n.get("settings/calendar/providers/1/token");if(e.data.token)return`${e.data.expires},${e.data.token}`}catch(e){console.error(e)}return null},c=async a=>{t.capture("calendar connect to google calendar click",{feature:"calendar",source:a});const r=(await e((async()=>{const{useCalendarEventStore:e}=await import("./calendarEvents-B6LH1_nk.js");return{useCalendarEventStore:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7]))).useCalendarEventStore();return new Promise(((e,a)=>{n.put("settings/calendar/providers",{provider_id:1}).then((a=>{const t=window.open(a.data.authorizationUrl,"sso","popup=true"),n=window.setInterval((()=>{t&&t.closed&&(clearInterval(n),r.refresh(!0),e())}),500)})).catch((e=>a(e)))}))},l=async()=>{t.capture("calendar disconnect google calendar click",{feature:"calendar"});const r=(await e((async()=>{const{useCalendarEventStore:e}=await import("./calendarEvents-B6LH1_nk.js");return{useCalendarEventStore:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7]))).useCalendarEventStore();return new Promise(((e,t)=>{n.delete("settings/calendar/providers/1").then((async()=>{await a.delete("googleCalendarAccessToken"),r.refresh(!0),e()})).catch((e=>t(e)))}))};export{c,l as d,s as g};