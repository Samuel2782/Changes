import{r as e}from"./index-DY0DW88M.js";function s(e,s,a={}){let i;const o=new Promise((e=>{i=e})),r=a=>{(async a=>(s(await t(e)),navigator.locks.request(e,a,(e=>(s(e),null===e?i():o)))))(a).catch((e=>{if(!(e instanceof DOMException)||"AbortError"!==e.name)throw e;s(null),r({...a,steal:!1})}))};return r(a),()=>i()}const t=async e=>{var s;return!!(null==(s=(await navigator.locks.query()).held)?void 0:s.every((s=>s.name!==e)))};class a{constructor(s,t={}){this.isLeader=e(void 0!==t.default?t.default:!!t.ifAvailable&&null),this.lockName=s,this.options=t,this.stepDown=()=>{},this.setupTabLeadership(t)}stealLeadership(){this.isLeader.value||this.setupTabLeadership({...this.options,steal:!0})}setupTabLeadership(e){const t=s(this.lockName,(e=>{this.isLeader.value=!!e}),e);this.stepDown(),this.stepDown=()=>{this.isLeader.value=!1,t()}}}export{a as T};