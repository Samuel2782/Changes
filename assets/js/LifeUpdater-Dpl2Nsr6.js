import{V as i}from"./ValueWithRandom-DOPLX5RJ.js";import{s as e,o as t,k as n,n as o,l as s}from"./FlashMessage-gZ_ihQT2.js";import"./AnimationOptions-7FVFIElj.js";import"./flashMessageQueue-Byrek2Yp.js";import"./DataSyncService-BnTv72BN.js";import"./index-DY0DW88M.js";import"./Logger-CErMjlBd.js";import"./style-cpFB66wV.js";import"./info-DdD9a7JK.js";import"./globalKeyEventManager-Dw4DvSNm.js";import"./icon-close-DRlspKs3.js";import"./_plugin-vue2_normalizer-DeUNqxFl.js";class a extends i{constructor(){super(),this.sync=!1}load(i){i&&(super.load(i),void 0!==i.sync&&(this.sync=i.sync))}}class r extends i{constructor(){super(),this.sync=!1}load(i){i&&(super.load(i),void 0!==i.sync&&(this.sync=i.sync))}}class l{constructor(){this.count=0,this.delay=new a,this.duration=new r}load(i){i&&(void 0!==i.count&&(this.count=i.count),this.delay.load(i.delay),this.duration.load(i.duration))}}class d{constructor(i){this.container=i}init(i){const e=this.container,t=i.options.life;t&&(i.life={delay:e.retina.reduceFactor?n(t.delay.value)*(t.delay.sync?1:s())/e.retina.reduceFactor*o:0,delayTime:0,duration:e.retina.reduceFactor?n(t.duration.value)*(t.duration.sync?1:s())/e.retina.reduceFactor*o:0,time:0,count:t.count},i.life.duration<=0&&(i.life.duration=-1),i.life.count<=0&&(i.life.count=-1),i.life&&(i.spawning=i.life.delay>0))}isEnabled(i){return!i.destroyed}loadOptions(i,...e){i.life||(i.life=new l);for(const t of e)i.life.load(null==t?void 0:t.life)}update(i,s){this.isEnabled(i)&&i.life&&function(i,s,a){if(!i.life)return;const r=i.life;let l=!1;if(i.spawning){if(r.delayTime+=s.value,!(r.delayTime>=i.life.delay))return;l=!0,i.spawning=!1,r.delayTime=0,r.time=0}if(-1===r.duration)return;if(i.spawning)return;if(l?r.time=0:r.time+=s.value,r.time<r.duration)return;if(r.time=0,i.life.count>0&&i.life.count--,0===i.life.count)return void i.destroy();const d=e(0,a.width),u=e(0,a.width);i.position.x=t(d),i.position.y=t(u),i.spawning=!0,r.delayTime=0,r.time=0,i.reset();const c=i.options.life;c&&(r.delay=n(c.delay.value)*o,r.duration=n(c.duration.value)*o)}(i,s,this.container.canvas.size)}}export{d as LifeUpdater};