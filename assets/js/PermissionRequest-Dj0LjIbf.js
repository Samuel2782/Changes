import{p as s}from"./promisifiedChrome-B6V9WMyE.js";import{I as e,a as t,ah as i,g as r,n as o}from"./index-DY0DW88M.js";import{S as n}from"./SmoothReflow-Cnw3bIxd.js";import a from"./icon-down-CXjJWZ3Q.js";import{n as l}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./Logger-CErMjlBd.js";import"./style-cpFB66wV.js";import"./ResizeSensor-ZXOsDHeC.js";import"./useAllComponentsMounted-RTvHVD2I.js";import"./DataSyncService-BnTv72BN.js";const d=l(e({name:"PermissionRequest",components:{SmoothReflow:n},props:{reason:{type:String,default:"To use this feature"},source:{type:String,default:"Momentum"},permissions:{type:Object,default:()=>{}},requestImmediately:{type:Boolean,default:!1},resolve:{type:Function,default:()=>{}},extraInstructions:{type:String,default:""},watchPermissionCheck:{type:Boolean,default:!1}},setup:()=>({browser:t.getBrowser()}),data:()=>({browserRequestOpen:!1,contentVisible:!1}),computed:{iconStyling:()=>({top:t.isWindowsOs()||t.isFirefox(),right:t.isFirefox()}),title(){return`${this.source} Requires Additional Permissions`},description(){return`${this.reason}, ${this.source} needs additional permissions.`}},created(){this.requestImmediately&&i()&&this.requestPermissions()},mounted(){m.widgetManager.hideApps({layer:"permissions"}),this.contentVisible=!0,this.watchPermissionCheck&&(r().permissions.onAdded.addListener(this.resolveIfGrantedFromWatcher),r().permissions.onRemoved.addListener(this.resolveIfGrantedFromWatcher))},destroyed(){m.widgetManager.showApps({layer:"permissions"}),this.watchPermissionCheck&&(r().permissions.onAdded.removeListener(this.resolveIfGrantedFromWatcher),r().permissions.onRemoved.removeListener(this.resolveIfGrantedFromWatcher))},methods:{requestPermissions(){this.browserRequestOpen=!0,s.permissions.request(this.permissions).then((s=>this.resolvePermissionRequest(s)),(s=>{console.error(s),this.resolvePermissionRequest(!1)}))},async resolvePermissionRequest(s){this.contentVisible=!1,await o(),this.resolve(s),this.$emit("dismiss")},resolveIfGrantedFromWatcher(){s.permissions.contains(this.permissions).then((s=>{s&&this.resolvePermissionRequest(!0)}))}}}),(function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"permission-overlay dark",attrs:{"data-test":"permission-overlay"}},[e("transition",{attrs:{name:"slide-down-fade",mode:"out-in"}},[s.contentVisible?e("div",{staticClass:"upper"},[e("div",{staticClass:"title"},[s._v(s._s(s.title))]),e("div",{staticClass:"description"},[s._v(s._s(s.description))]),s.extraInstructions?e("div",{staticClass:"extra-instructions"},[s._v(s._s(s.extraInstructions))]):s._e(),e("smooth-reflow",[s.browserRequestOpen?s._e():e("div",{staticClass:"action-buttons-wrapper"},[e("div",{staticClass:"privacy"},[s._v("We value and protect your privacy. Learn more in our "),e("a",{attrs:{href:"https://momentumdash.com/legal/privacy",target:"_blank"}},[s._v("Privacy Policy.")])]),e("div",{staticClass:"button-row"},[e("div",{staticClass:"dash-button dash-button-neutral",attrs:{"data-test":"deny-permissions"},on:{click:function(e){return s.resolvePermissionRequest(!1)}}},[s._v("Go back")]),e("div",{staticClass:"dash-button dash-button-primary",attrs:{"data-test":"allow-permissions"},on:{click:s.requestPermissions}},[s._v("Continue")])])])]),e("smooth-reflow",{staticClass:"arrow-wrapper",class:s.iconStyling},[s.browserRequestOpen?e("div",[e("div",{staticClass:"icon"},[e("inline-svg",{staticClass:"icon",attrs:{src:a}})],1)]):s._e()])],1):s._e()]),e("div",{staticClass:"center"}),e("div",{staticClass:"lower"})],1)}),[],!1,null,"46c1fa49").exports;export{d as default};